---
title: "HW6"
author: "Yongye Tan"
date: "2022-12-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

# 1 IMDb data 

```{r}
imdb <- read.csv(file = "imdb_titles.csv")
head(imdb)
```
## a
```{r}
# i.
nrow(imdb)
ncol(imdb)
# There are 8007 observations and 8 variables i nteh dataset.

# ii.
summary(imdb)
# There are 7334 missing endYear, 7 missing runtimeMinutes in the databset. 
# How we should dael with them?
# Since the endYear column have more than half of the values are missing, then this column does not have any substantial meaning to the dataset, I suggest that we drop this column. We can also drop the 7 missing runtimeMinutes since it does not have a huge impact on the entire dataset.

imdb <- imdb %>%
  select(primaryTitle, titleType, startYear,
         runtimeMinutes, genres, averageRating, numVotes) %>% 
  drop_na()
```

## b
```{r}
ggplot(data = imdb, 
       mapping = aes(x = titleType, y = startYear)) + 
  geom_boxplot() + 
  labs (x = "Type", 
        y = "year of the movie",
        title = "Distribution of type of the movies vs the year released")

# I found out that there are lots of movie outlier, and movie has the longest range among the three types. Movies are clustered around 1900 to 1930, but there weren't any movies between 1930 and 1975. tvEpisode emerges at the latest at around 2010, and it has the smallest  range and only outlier, which means it was not as popular as movie and tvSeries, whereas tvSeries has a lot of outliers closer to the tail of the boxplot, meaning it was getting popular and popular since it existed. 

```

## c
```{r}

imdb2 <- imdb %>% 
  group_by(startYear) %>% 
  summarise(avg_time = mean(runtimeMinutes, na.rm = TRUE)) 


ggplot(data = imdb2, mapping = 
         aes(x = startYear, y = avg_time)) + 
  geom_point() + 
  labs(x = "Year",
       y = "average time of movie",
       title = "Year vs duration of movie",
       subtitle =  "Why do people like watching movies that last for 100 minutes?")

```

## d
```{r}

```
